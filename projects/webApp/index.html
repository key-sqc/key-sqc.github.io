<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>去中心化即时通讯</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>去中心化即时通讯</h1>
            <p>点对点加密聊天 · 无需服务器</p>
        </div>
        
        <div class="connection-panel">
            <div class="connection-status">
                <div class="status-indicator" id="statusIndicator"></div>
                <span id="statusText">等待连接...</span>
            </div>
            
            <!-- 详细状态信息 -->
            <div class="status-details" id="statusDetails">
                <div class="status-item">
                    <span class="status-label">WebRTC状态:</span>
                    <span class="status-value" id="webrtcStatus">未初始化</span>
                </div>
                <div class="status-item">
                    <span class="status-label">数据通道:</span>
                    <span class="status-value" id="dataChannelStatus">未连接</span>
                </div>
                <div class="status-item">
                    <span class="status-label">ICE连接:</span>
                    <span class="status-value" id="iceStatus">未开始</span>
                </div>
            </div>
            
            <div class="connection-actions">
                <button id="createBtn">创建连接</button>
                <button id="connectBtn">加入连接</button>
                <button id="disconnectBtn" style="display: none;">断开连接</button>
            </div>
            
            <div class="connection-code" id="connectionCodeContainer" style="display: none;">
                <p>您的连接代码：</p>
                <div class="code-display" id="connectionCode"></div>
                <button id="copyCodeBtn">复制代码</button>
            </div>
            
            <!-- 连接日志 -->
            <div class="connection-log" id="connectionLog">
                <div class="log-header">连接日志</div>
                <div class="log-content" id="logContent"></div>
            </div>
        </div>
        
        <div class="chat-container">
            <div class="messages" id="messages">
                <div class="message received">
                    <div class="message-text">欢迎使用去中心化即时通讯！请先建立连接。</div>
                    <div class="message-time">系统消息</div>
                </div>
            </div>
            
            <div class="input-area">
                <input type="text" id="messageInput" placeholder="输入消息..." disabled>
                <button class="send-btn" id="sendBtn" disabled>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M22 2L11 13" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
            </div>
        </div>
        
        <div class="info-box">
            <h3>使用说明</h3>
            <ul>
                <li>1. 一方点击"创建连接"，生成连接代码</li>
                <li>2. 另一方点击"加入连接"，输入连接代码</li>
                <li>3. 连接成功后即可开始聊天</li>
                <li>4. 所有消息通过点对点连接直接传输</li>
            </ul>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>